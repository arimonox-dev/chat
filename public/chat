<!DOCTYPE html>
<html>
<head>
  <title>IPFS Chat</title>
  <script src="https://cdn.jsdelivr.net/npm/ipfs/dist/index.min.js"></script>
  <script>
     const sever = 0
     async function main(){
         const topic = "javachat"
          sever = await Ipfs.create()
          const version = await server.version()
          console.log('IPFS Version:', version.version)
          const id = await(await server.id()).id.toString()
          console.log('IPFS ID:', id)
          server.swarm.connect('/dns4/bootstrap.libp2p.io/tcp/443/wss/p2p/QmNnooDu7bfCQ5mc2pXfVW48y17NMx3jYz7vxnJ1xEGV3W')
          await server.pubsub.subscribe(topic, (message) => {
                 const data = message.data.toString();
                 console.log('Pesan diterima:', data);
          });
          const peer = await sever.swarm.peers()
          console.log(peer)
     }

    async function publishMessage(topic, message) {
        try {
main()
            const data = new TextEncoder.encode(message)
           await server.pubsub.publish(topic, data);
           console.log('Pesan terkirim!');
main()
       } catch (error) {
        console.error('Terjadi kesalahan saat mengirim pesan:', error);
      }
   }

     
    const message = 'Halo, dunia!';
    publishMessage(topic, message);
  </script>
</head>
<body>
  <h1>IPFS Chat</h1>
  <input type="text" id="message" placeholder="Type your message">
  <button onclick="publishMessage()">Publish</button>
</body>
</html>
